<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Rico-Popup Controls</title>

<script src="LoadRicoClient.js" type="text/javascript"></script>
<link href="../demo.css" type="text/css" rel="stylesheet" />

<script type='text/javascript'>
var cal1,cal2,cal3,cal1Box,cal2Box,cal3Box;
var colorpicker,colorBox

Rico.onLoad( function() {

  // initialize calendar  (addHoliday calls are optional)
  cal1Box=Rico.$('CalendarValue1');
  cal1=new Rico.CalendarControl("cal1");
  cal1.addHoliday(25,12,0,'Christmas','#F55','white');
  cal1.addHoliday(1,1,0,'New Years','#2F2','white');
  cal1.returnValue=function(newVal) { cal1Box.value=newVal; };
  SetDateFormat();

  // initialize calendar #2 (show week #)
  cal2Box=Rico.$('CalendarValue2');
  cal2=new Rico.CalendarControl("cal2", {showWeekNumber:1});
  cal2.returnValue=function(newVal) { cal2Box.value=newVal; };

  // initialize calendar #3 (no "Today is")
  cal3Box=Rico.$('CalendarValue3');
  cal3=new Rico.CalendarControl("cal3", {showToday:0});
  cal3.returnValue=function(newVal) { cal3Box.value=newVal; };
  
  // initialize color picker
  colorpicker=new Rico.ColorPicker("colorpicker1");
  colorpicker.returnValue=ProcessColorSelection;
  colorBox=Rico.$('ColorValue');
  
  for (var i=1; i<=3; i++) {
    Rico.eventBind('CalendarButton'+i,"click", Rico.eventHandle(window,'CalendarClick'+i));
  };
  Rico.eventBind('ColorButton',"click", Rico.eventHandle(window,'ColorClick'));
  Rico.eventBind('TextButton',"click", Rico.eventHandle(window,'DisplayText'));
  
  Rico.log('onLoad finished');
});

function CalendarClick1(e) {
  if (Rico.visible(cal1.container)) {
    cal1.close();
  } else {
    cal2.close();
    cal3.close();
    colorpicker.close();
    cal1.open(cal1Box.value);
    Rico.positionCtlOverIcon(cal1.container,'CalendarButton1');
    cal1.move();
  }
  Rico.eventStop(e);
}

function SetDateFormat(e) {
  cal1Box.value='';
  var sel=Rico.$('CalFormat');
  cal1.setDateFmt(sel.options[sel.selectedIndex].text);
}

function CalendarClick2(e) {
  if (Rico.visible(cal2.container)) {
    cal2.close();
  } else {
    cal1.close();
    cal3.close();
    colorpicker.close();
    cal2.open(cal2Box.value);
    Rico.positionCtlOverIcon(cal2.container,'CalendarButton2');
    cal2.move();
  }
  Rico.eventStop(e);
}

function CalendarClick3(e) {
  if (Rico.visible(cal3.container)) {
    cal3.close();
  } else {
    cal1.close();
    cal2.close();
    colorpicker.close();
    cal3.open(cal3Box.value);
    Rico.positionCtlOverIcon(cal3.container,'CalendarButton3');
    cal3.move();
  }
  Rico.eventStop(e);
}

function ProcessColorSelection(newVal) {
  colorBox.value=newVal;
  // set text box background to the selected color
  colorBox.style.backgroundColor=newVal;
  colorBox.style.color= Rico.isWebKit ? 'black' : TextColor(newVal);
}

// choose black or white text - whichever gives the best contrast
function TextColor(hexval) {
  var objColor=Rico.Color.createFromHex(hexval);
  return (objColor.rgb.g > 160 || objColor.rgb.r+objColor.rgb.g+objColor.rgb.b > 480) ? 'black' : 'white';
}

function ColorClick(e) {
  if (Rico.visible(colorpicker.container)) {
    colorpicker.close();
  } else {
    Rico.positionCtlOverIcon(colorpicker.container,'ColorButton');
    cal1.close();
    cal2.close();
    cal3.close();
    colorpicker.open();
  }
  Rico.eventStop(e);
}

var PopupCnt=0;
function DisplayText(e) {
  Rico.eventStop(e);
  var txt=Rico.$('TextBox').value;
  if (!txt) {
    alert('Enter some text first!');
    return;
  }
  PopupCnt++;
  var options={
    hideOnClick: false,
    zIndex     : PopupCnt+10,   // ensures shadows layer correctly
    height     : '200px',
    width      : '300px',
    overflow   : 'auto'
  };
  var popup=new Rico.Window('Window #'+PopupCnt,options);
  popup.setContent(txt);

  // pick a random location in the upper-left quadrant of the screen
  var x=Math.floor(Math.random()*Rico.windowWidth()/2);
  var y=Math.floor(Math.random()*Rico.windowHeight()/2);
  popup.openPopup(x,y);
}
</script>

<style>
body {font-family: Arial, Tahoma, Verdana;}
#row1 span {
  font-size: 8pt;
}
#CalFormat {
  font-size: 8pt;
}
</style>
</head>

<body>

<div id='explanation'>
Base Library: 
<script type='text/javascript'>
document.write(Rico.Lib+' '+Rico.LibVersion);
</script>
<hr>
<h1>Rico: Popup Controls</h1>
<p>This example displays the Rico Calendar in various formats and the Rico Color Picker,
as well a displaying a dialog window.
</p>
</div>


<table border='1' cellspacing='0' cellpadding='7'>
<tr id='row1' valign='top'>
<td><button id='CalendarButton1'>Calendar</button>
<br><select id='CalFormat' onchange='SetDateFormat(event)'>
<option>yyyy-mm-dd</option>
<option>dd-mm-yyyy</option>
<option>mm/dd/yyyy</option>
</select>
</td>
<td><button id='CalendarButton2'>Calendar with<br>Week Number</button></td>
<td><button id='CalendarButton3'>Calendar without<br>"Today is"</button></td>
<td><button id='ColorButton'>Color Picker</button></td>
</tr>
<tr>
<td><input type='text' id='CalendarValue1' size='10'></td>
<td><input type='text' id='CalendarValue2' size='10'></td>
<td><input type='text' id='CalendarValue3' size='10'></td>
<td><input type='text' id='ColorValue' size='8'></td>
</tr>
</table>

<p><table border='1' cellspacing='0' cellpadding='7' style='background-color:#DDD;'>
<tr><td>
<span style='font-size:small;'>
Type or paste some text into the box, then click the button.
<br>Open popups can be dragged around the page.
<br>Type "Esc" to close all popups.
</span>
<br><textarea id='TextBox' rows='6' cols='70'>
Lorem ipsum dolor sit amet, consectetur adipisicing elit, 
sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris 
nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
reprehenderit in voluptate velit esse cillum dolore eu fugiat 
nulla pariatur. Excepteur sint occaecat cupidatat non proident, 
sunt in culpa qui officia deserunt mollit anim id est laborum.
</textarea>
<br><button id='TextButton'>Display text in window</button>
</td></tr>
</table>

</body>
</html>
